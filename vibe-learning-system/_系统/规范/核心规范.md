# 核心规范

所有Agent必须遵守的核心规则。

---

## 📊 项目信息.md更新规范

### 字段结构（6大字段）

#### A. 基础信息（初始化后不变）
```markdown
# 项目信息
**项目名称**：[项目名]
**创建时间**：[YYYY-MM-DD]
```
- 初始化：建造Agent（项目启动时）
- 更新者：无

#### B. 种子状态（输入Agent维护）
```markdown
## 🌱 种子状态（v0.1）
**已捕获种子**：X个
**最近捕获**：[种子标题]
```
- 更新者：输入Agent
- 更新时机：捕获新种子后

#### C. 炼金记录（炼金Agent维护）
```markdown
## ⚗️ 炼金记录（v0.2）
**已完成碰撞**：X次
**最近炼金**：[种子A] + [种子B] → [洞察卡片]
```
- 更新者：炼金Agent
- 更新时机：完成碰撞生成后

#### D. 洞察卡片列表（炼金Agent维护）
```markdown
## 💡 已生成的洞察卡片

### 第N次炼金
1. [[洞察卡片/[序号]. [标题].md|[序号]. [标题]]] ← [[种子/[种子A].md|种子A]] + [[种子/[种子B].md|种子B]]
```
- 更新者：炼金Agent
- 更新时机：生成洞察卡片后

#### E. 项目建造记录（建造Agent维护）
```markdown
## 🏗️ 建造状态（v0.3）
**当前项目**：[项目名] 或 无
**已吸附种子**：Y个
**已吸附洞察**：Z个
```
- 更新者：建造Agent
- 更新时机：创建/更新项目后

#### F. 输出记录（建造Agent维护）
```markdown
## 📤 输出记录
**最终产出**：[文件名] 或 无
```
- 更新者：建造Agent
- 更新时机：生成最终文章后

---

## 📁 文件操作规范

### 项目结构
```
vibe-learning-system/（工作目录名）
├── _系统/（系统文件）
└── 库房/（所有内容）
    ├── 种子池/（所有捕获的种子）
    ├── 洞察卡片/（炼金生成的洞察）
    └── 项目/（所有项目）
        └── [项目名]/
            ├── 项目信息.md
            ├── 吸附白板.canvas
            └── 最终产出.md
```

### 路径规则
- **当前工作目录**：通过 `pwd` 自动检测，提取最后一级目录名作为{WORK_DIR}
- **文件操作**（mkdir/Read/Write/Edit）：使用**相对路径** `库房/`、`_系统/`
- **Obsidian功能**（Canvas/双链）：使用**完整路径** `{WORK_DIR}/库房/...`
- ✅ 正确：`mkdir -p "库房/种子池"`
- ✅ 正确：`Read "库房/种子池/01. 熵增定律很有趣.md"`
- ✅ 正确（Canvas）：`{WORK_DIR}/库房/项目/生活哲学/吸附白板.canvas`
- ❌ 错误：`mkdir -p "种子池"`（缺少"库房/"前缀）

### 文件命名
- 项目名：简洁、准确（AI自己提取，不问用户）
- 种子文件：`[序号]. [原始文本].md`（序号从01开始，保留用户原始输入）
- 洞察卡片：`[序号]. [洞察标题].md`（序号从01开始）
- 项目文件：保留原始输入，AI生成"种子摘要"

---

## 🔑 核心原则

### 1. 无压力捕获（土壤）
- 极低摩擦：用户可以随时抛入任何信息
- 自动去噪：AI自动提取核心观点，生成1-2句种子摘要
- 语义标签：后台向量化，为后续吸附做准备

### 2. AI驱动炼金（炼金）
- 随机碰撞：界面随机展示两个种子卡片
- AI催化剂：分析两张看似无关的卡片，生成3个潜在关联方向
- 合成新知：用户基于AI提示确认连接，生成新洞察卡片

### 3. 磁性建造（项目）
- 项目定义：用户输入模糊目标（如"我想写一篇关于非线性叙事的文章"）
- AI磁铁：语义检索，自动将相关种子和洞察"吸附"到项目看板
- 苏格拉底助手：主动提问，发现缺失的支持

### 4. AI角色定位
在这个系统中，AI不是：
❌ 自动帮你写完论文的代笔者
❌ 只是用来聊天的ChatGPT窗口

在这个系统中，AI是：
✅ **园丁**：帮你修剪杂乱的信息，通过修剪让核心显露
✅ **媒人**：向你介绍两个陌生概念，并告诉你它们为什么可能是一对
✅ **策展人**：当你设定展览主题（项目）时，它从库房里找出最合适的展品

---

## 🔄 Agent职责解耦

| Agent | 主要职责 | 核心动作 | 更新字段 |
|-------|---------|---------|---------|
| 输入Agent | 捕获种子 | 修剪摘要 + 向量化标记 | 种子状态 |
| 炼金Agent | 碰撞炼金 | 随机碰撞 + 关联分析 + 生成洞察 | 炼金记录、洞察卡片列表 |
| 建造Agent | 项目建造 | 语义吸附 + 白板组织 + 生成文章 | 建造状态、输出记录 |

**核心原则**：每个字段只由一个Agent维护，无冲突。

---

## ⚙️ 工作流切换规则

### 输入 → 炼金
触发条件：
- 用户说"进入炼金台"、"看看炼金"、"开始碰撞"
- 或用户连续捕获3个种子后，AI主动建议

### 炼金 → 建造
触发条件：
- 用户说"创建项目"、"开始建造"、"吸附到项目"
- 或炼金生成5个洞察后，AI主动建议

### 建造 → 输入
触发条件：
- 用户说"捕获新种子"、"添加内容"
- 返回库房继续收集

### 任意 → 任意
用户可以用快捷命令明确切换：
- `/输入` 或 `捕获` → 输入Agent
- `/炼金` 或 `碰撞` → 炼金Agent
- `/建造` 或 `项目` → 建造Agent

---

## 🎯 交互流程标准

### 标准三阶段流程
1. **输入（土壤）**：用户丢入一句话 → AI修剪成种子摘要 → 向量化标记
2. **炼金（碰撞）**：系统随机推出两张卡片 → AI提示3个关联方向 → 用户确认连接 → 生成洞察卡片
3. **建造（项目）**：用户定义项目目标 → AI语义检索 → 自动吸附相关内容 → 生成最终文章

### AI的主动引导
- 捕获3个种子后：建议进入炼金台
- 炼金5个洞察后：建议创建项目
- 建造时发现缺失：主动提问是否补充

### 用户的自由切换
- 任何时候用户都可以明确说切换到其他Agent
- 不需要按固定流程，可以来回跳转
- 项目建造过程中可以随时捕获新种子
